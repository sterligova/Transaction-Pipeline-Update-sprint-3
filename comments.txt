Привет Максим!


Спасибо за твои комментарии.
К сожалению, в этом проекте изначально все пошло не так, 
по описанию к проекту должен был быть приложен эталонный рабочий DAG но его не было.
И второстепенные таблицы тоже все были пустые. И без прописания в теле daga параметров подключения, 
эирфлоу в логах выдавал ошибку, что не видит никаких connection, хотя в веб-интерфейсе Airflow они все были прописаны.


Поэтому я "слепила" DAG по образу и подобию DAGa в 3 спринте. А там нас учили как раз
 вставлять код sql в тело DAGa. Спасибо за подсказку, что этого делать не надо и другие советы.


Если я поняла правильно основная моя ошибка, что я удаляю перед вставкой все данные (что конечно не верно),
а нужно добавить условие на удаление данных за конкретный период, который вставляем (where table_name.date_time::Date = '{{ds}}')

